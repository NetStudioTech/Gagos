# S3 Storage

GAGOS provides a browser for S3-compatible object storage services.

## Supported Providers

- **AWS S3** - Amazon Simple Storage Service
- **MinIO** - Self-hosted S3-compatible storage
- **DigitalOcean Spaces** - DO object storage
- **Backblaze B2** - B2 Cloud Storage (S3-compatible API)
- **Any S3-compatible service**

## Connecting

1. Open the S3 Storage window
2. Configure connection:
   - Endpoint (e.g., `s3.amazonaws.com` or `minio.local:9000`)
   - Region (e.g., `us-east-1`)
   - Access Key ID
   - Secret Access Key
   - SSL enabled/disabled
3. Click "Connect"

**Presets available:**
- AWS S3 (s3.amazonaws.com)
- MinIO (localhost:9000)

## Features

### Buckets Tab

Manage S3 buckets:

#### List Buckets

View all buckets with:
- Bucket name
- Creation date

#### Create Bucket

1. Click "Create Bucket"
2. Enter bucket name (must be globally unique for AWS)
3. Click "Create"

**Bucket naming rules:**
- 3-63 characters
- Lowercase letters, numbers, hyphens
- Cannot start/end with hyphen
- Cannot contain consecutive hyphens

#### Delete Bucket

1. Click "Delete" on a bucket
2. Confirm deletion
3. Bucket must be empty to delete

### Objects Tab

Browse and manage objects within a bucket:

#### Navigate

- Click a bucket to view its contents
- Click folders to navigate into them
- Click "Up" to go to parent folder
- View current path in breadcrumb

#### Upload Files

1. Click "Upload"
2. Select files from your computer
3. Files are uploaded to current folder
4. Progress shown during upload

**Multi-file upload supported.**

#### Download Files

1. Click "Download" icon on a file
2. File downloads to your computer

#### Delete Files

1. Click "Delete" icon on a file
2. Confirm deletion
3. File is removed

#### File Information

Click "Info" on a file to view:
- File size
- Content type
- Last modified date
- ETag (MD5 hash)
- Custom metadata

#### Presigned URLs

Generate temporary shareable links:

1. Click "Info" on a file
2. Click "Generate Presigned URL"
3. Select expiration time (1h, 24h, 7d)
4. Copy the generated URL
5. Share URL - anyone with it can download

**Note:** Presigned URLs bypass authentication and grant temporary access.

## API Reference

```bash
# Connect and list buckets
curl -X POST http://localhost:8080/api/v1/storage/s3/connect \
  -H "Content-Type: application/json" \
  -d '{
    "endpoint":"s3.amazonaws.com",
    "region":"us-east-1",
    "access_key_id":"AKIAXXXXXXXX",
    "secret_access_key":"xxxxx",
    "use_ssl":true
  }'

# List buckets
curl -X POST http://localhost:8080/api/v1/storage/s3/buckets \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", ...}'

# Create bucket
curl -X POST http://localhost:8080/api/v1/storage/s3/bucket/create \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", "bucket":"my-new-bucket", ...}'

# List objects
curl -X POST http://localhost:8080/api/v1/storage/s3/objects \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", "bucket":"my-bucket", "prefix":"folder/", ...}'

# Get object info
curl -X POST http://localhost:8080/api/v1/storage/s3/object/info \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", "bucket":"my-bucket", "key":"file.txt", ...}'

# Generate presigned URL
curl -X POST http://localhost:8080/api/v1/storage/s3/object/presign \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", "bucket":"my-bucket", "key":"file.txt", "expiry":"24h", ...}'

# Upload object
curl -X POST http://localhost:8080/api/v1/storage/s3/object/upload \
  -H "Content-Type: application/json" \
  -d '{
    "endpoint":"...",
    "bucket":"my-bucket",
    "key":"uploaded-file.txt",
    "data":"base64-encoded-content",
    "content_type":"text/plain",
    ...
  }'

# Download object
curl -X POST http://localhost:8080/api/v1/storage/s3/object/download \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", "bucket":"my-bucket", "key":"file.txt", ...}'

# Delete object
curl -X POST http://localhost:8080/api/v1/storage/s3/object/delete \
  -H "Content-Type: application/json" \
  -d '{"endpoint":"...", "bucket":"my-bucket", "key":"file.txt", ...}'
```

## Provider-Specific Configuration

### AWS S3

```
Endpoint: s3.amazonaws.com (or regional: s3.us-west-2.amazonaws.com)
Region: us-east-1 (or your bucket's region)
Access Key: IAM access key
Secret Key: IAM secret key
SSL: Enabled
```

### MinIO

```
Endpoint: minio.local:9000
Region: us-east-1 (or any)
Access Key: MinIO access key
Secret Key: MinIO secret key
SSL: Depends on setup
```

### DigitalOcean Spaces

```
Endpoint: nyc3.digitaloceanspaces.com (or your region)
Region: nyc3 (or your region)
Access Key: Spaces access key
Secret Key: Spaces secret key
SSL: Enabled
```

## Security Notes

1. **Credentials are session-only** - Not stored permanently
2. **Use IAM policies** - Limit access to specific buckets/actions
3. **Presigned URL caution** - Anyone with URL can access the file
4. **Audit access** - Enable S3 access logging for compliance
